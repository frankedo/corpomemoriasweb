<!DOCTYPE html>
<html lang="es">
<head>

     <meta charset="utf-8">
    <meta name="google-site-verification@corpomemorias.netlify.app" content="6Jg75i6_BVhEGzpzF3FTG7wEbW5mF48oGYLUYFc8Gyk">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sitio oficial de la Corporación Marlón Memorias y Huellas de un Desaparecido - Corpomemorias Aguachica. Luchamos por la dignidad de los desaparecidos en Colombia.">
    <meta name="author" content="Devcrud">
	<!-- Palabras clave para toda la organización -->
    <meta name="keywords" content="Corpomemorias, memoria histórica, desaparición forzada, víctimas, museo virtual, cultura, resistencia, Colombia" />

    <title>CORPOMEMORIAS</title>




 <!-- SEO Mejorado -->
  <link rel="canonical" href="https://corpomemorias.netlify.app">
  <meta property="og:title" content="Corpomemorias | Memoria y Dignidad">
  <meta property="og:description" content="Preservamos la memoria de los desaparecidos en Colombia. Conoce nuestra lucha y participa.">
  <meta property="og:image" content="https://corpomemorias.netlify.app/assets/imgs/og-image.jpg">
  <meta property="og:url" content="https://corpomemorias.netlify.app">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Corpomemorias | Memoria y Dignidad">
  <meta name="twitter:description" content="Preservamos la memoria de los desaparecidos en Colombia. Conoce nuestra lucha y participa.">
  <meta name="twitter:image" content="https://corpomemorias.netlify.app/assets/imgs/og-image.jpg">
   
     <!-- Otros enlaces y metadatos -->
    <!-- Lightbox CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css" rel="stylesheet" />
    <!-- Lightbox JS with defer -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox-plus-jquery.min.js" defer></script>
    <!-- font icons -->
    <link rel="stylesheet" href="../assets/vendors/themify-icons/css/themify-icons.css">
        <!-- Bootstrap + Creative Design main styles -->
    <link rel="stylesheet" href="../assets/css/creative-design.css">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
        <!-- Popper.js, required for Bootstrap tooltips -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

	<!-- PARA LOS BOTONES COMPARTIR-->
	<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>





<body data-spy="scroll" data-target=".navbar" data-offset="40" id="home">
    
    <!-- Page Navbar -->
    <nav id="scrollspy" class="navbar page-navbar navbar-light navbar-expand-md fixed-top" data-spy="affix" data-offset-top="20">
        <div class="container">
            <a class="navbar-brand" href="../index.html"><strong class="text-primary">Corporación</strong> <span class="text-dark">Marlón Memorias</span></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav><!-- End of Page Navbar -->   

<!-- Page Header -->
<header id="home" class="header">
    <div class="overlay"></div>
    <div class="header-content" style="display: flex; flex-direction: column; align-items: center;">
      
        
            <p>Corporación Marlón Memorias y Huellas de un Desaparecido</p>
            <h6>Archivo Digital</h6> 
        <!-- Botón de WhatsApp ajustado con ancho fijo y centrado -->
        <a href="https://wa.me/+573044868541?text=¡Hola!%20Quisiera%20más%20información" target="_blank" class="btn btn-outline-light" 
           style="display: flex; align-items: center; width: 250px; justify-content: center;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/WhatsApp_icon.png" alt="WhatsApp" 
                 style="width: 20px; height: 20px; margin-right: 8px;">
           Conéctate con nosotros
        </a>
    </div>      
</header>
<!-- End of Page Header -->

	


	




	


    <style>
        .card {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .card-img-top {
            height: 250px;
            object-fit: cover;
            background: #f0f0f0;
        }
        .loader {
            width: 100%;
            height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #eee;
            color: #555;
            font-size: 18px;
        }
    </style>
</head>

<body>

<div class="container py-5">
    <h1 class="text-center mb-4">Publicaciones</h1>

    <div id="lista-publicaciones" class="row"></div>
</div>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
    "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";

async function obtenerPortadaPDF(urlPDF) {
    try {
        const loadingTask = pdfjsLib.getDocument(urlPDF);
        const pdf = await loadingTask.promise;
        const page = await pdf.getPage(1);

        const viewport = page.getViewport({ scale: 1.5 });
        const canvas = document.createElement("canvas");
        const context = canvas.getContext("2d");

        canvas.width = viewport.width;
        canvas.height = viewport.height;

        await page.render({ canvasContext: context, viewport }).promise;

        return canvas.toDataURL();
    } catch (err) {
        console.error("Error cargando portada:", err);
        return "https://placehold.co/300x400?text=Sin+Portada";
    }
}
</script>

<!-- Render Cards -->
<script>
document.addEventListener("DOMContentLoaded", async () => {
    const contenedor = document.getElementById("lista-publicaciones");

    // *** CAMBIA ESTA URL POR TU BACKEND RENDER ***
    const backendURL = "https://supabase-backend-1-g0bt.onrender.com";

    try {
        const res = await fetch(`${backendURL}/publicaciones`);
        const publicaciones = await res.json();

        publicaciones.forEach(pub => {
            const col = document.createElement("div");
            col.className = "col-md-4 mb-4";

            col.innerHTML = `
                <div class="card">
                    <div class="loader">Cargando portada...</div>
                    <img class="card-img-top d-none portada-generada" data-pdf="${pub.url_pdf}" alt="Portada PDF">

                    <div class="card-body">
                        <h5 class="card-title">${pub.titulo}</h5>
                        <p class="card-text">${pub.descripcion || ""}</p>

                        <a href="${pub.url_pdf}" target="_blank" class="btn btn-primary btn-block">
                            Ver PDF
                        </a>
                    </div>
                </div>
            `;

            contenedor.appendChild(col);
        });

        // Luego cargamos portadas reales
        const imagenes = document.querySelectorAll(".portada-generada");

        imagenes.forEach(async img => {
            const urlPDF = img.dataset.pdf;
            const portada = await obtenerPortadaPDF(urlPDF);

            const loader = img.previousElementSibling;
            loader.classList.add("d-none");

            img.src = portada;
            img.classList.remove("d-none");
        });

    } catch (err) {
        console.error("Error cargando publicaciones:", err);
        contenedor.innerHTML =
            `<div class="col-12"><div class="alert alert-danger">Error cargando publicaciones.</div></div>`;
    }
});
</script>

<!-- Bootstrap scripts -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>

</body>
</html>
